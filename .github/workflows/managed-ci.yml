# # WARNING: This file is autogenerated - changes will be overwritten if not made via https://github.com/microsoft/fde-mgmt
name: FDE CI

on: pull_request

jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/create-github-app-token@v2
        id: app-token
        with:
          app-id: ${{ vars.FDE_GITHUB_APP_ID }}
          private-key: ${{ secrets.FDE_GITHUB_APP_PRIVATE_KEY }}
          owner: ${{ vars.FDE_GITHUB_APP_REPO_OWNER }}
          repositories: ${{ vars.FDE_GITHUB_APP_REPO_NAME }}

      - run: |
          gh workflow run \
            callable-ci.yml \
            --repo ${{ vars.FDE_GITHUB_APP_REPO_OWNER }}/${{ vars.FDE_GITHUB_APP_REPO_NAME }} \
            --ref pulumi-setup \
            --field repository=${{ github.repository }} \
            --field sha=${{ github.event.pull_request.head.sha }}
        env:
          GITHUB_TOKEN: ${{ steps.app-token.outputs.token }}
